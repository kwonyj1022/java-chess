# java-chess

체스 미션 저장소

## 우아한테크코스 코드리뷰

- [온라인 코드 리뷰 과정] (https://github.com/woowacourse/woowacourse-docs/blob/master/maincourse/README.md)

---

## 💡프로젝트 개요
- 체스 게임을 진행할 수 있는 프로젝트입니다.
---


## 📋 구현 기능 목록

## controller

---

- [x] 게임 시작 문구를 출력한다.
- [x] 명령어 안내 문구를 출력한다.
- [x] 사용자 명령어를 입력한다.
  - [x] 명령어는 start, end로 구성된다.
- [x] start 명령어가 입력되면 게임을 시작한다.
  - [x] DB에 저장된 게임이 있으면 저장된 정보로 체스판을 세팅한다.
  - [x] DB에 저장된 게임이 없으면 초기 체스판을 세팅한다.
- [x] 체스판 현황을 출력한다.
- [x] 체스판에 King이 모두 살아있는지 확인하고, 죽었다면 예외를 던진다.
- [x] 체스판에 King이 모두 살아있다면, 사용자의 입력을 받아 체스 게임을 진행시킨다.
- [x] 게임을 진행시키면서 말을 움직일 때마다 King이 죽었는지 매번 판단한다.
  - [x] 죽었다면 db에 저장된 정보를 삭제하고, 예외를 던진다.
  - [x] 살아있다면 db에 상태를 업데이트하고, 게임을 진행시킨다.
- [x] status가 입력되면 각 진영의 점수를 출력하고, 어느 진영이 이겼는지 결과를 볼 수 있다.
- [x] end가 입력되면 프로그램을 종료한다.
  - [x] 종료하기 전에 db에 저장하고 종료한다.

## model

---
### chessGame
- [x] 체스판을 초기화할 수 있다.
  - [x] 체스판의 가로 위치는 왼쪽부터 a~h이다.
  - [x] 체스판의 세로 위치는 아래부터 위로 1~8이다.
  - [x] 살아있는 말의 현황을 관리한다.
- [x] King이 죽었는지 판단할 수 있다.
  - [x] 현재 체스판에 King이 2개이면 죽지 않았다고 판단한다.
  - [x] 현재 체스판에 King이 2개가 아니면 예외가 발생한다.
- [x] 체스판에서 입력받은 위치로 말이 이동할 수 있는지 판단한다.
  - [x] 흰색부터 번갈아가면서 말을 이동시킬 수 있다.
    - [x] 자신의 차례인지 확인한다. (출발좌표에 있는 말이 현재 말을 이동시킬 차례인지 확인한다.)
    - [x] 자신의 차례가 아니면 예외가 발생한다.
  - [x] 말이 이동할 수 있다면 이동시킨다.
    - [x] 목표 좌표에 말이 없고 경로 상에 다른 말이 없으면 말을 이동시킬 수 있다.
    - [x] 목표 좌표에 상대 말이 있고 경로 상에 다른 말이 없으면 상대 말을 잡고 이동시킬 수 있다.
  - [x] 이동할 수 없다면 예외가 발생한다.
    - [x] 출발 좌표에 말이 존재하지 않는 경우 예외가 발생한다.
    - [x] 진행 경로 상에 말이 있는 경우 예외가 발생한다.
    - [x] 목표 좌표에 자신의 말이 존재하는 경우 예외가 발생한다.
  - [x] 말이 폰이라면 다음과 같은 규칙을 따른다.
    - [x] 전진할 때 이동 경로에 말이 없으면 이동할 수 있다.
    - [x] 전진할 때 목적 좌표에 상대 말이 존재해도 예외가 발생한다.
    - [x] 대각선으로 이동할 때 이동 경로에 상대의 말이 존재하면 잡고 이동할 수 있다.
    - [x] 대각선으로 이동할 때 이동 경로에 상대의 말이 존재하지 않으면 예외가 발생한다.
- [x] 현재 남아 있는 말에 대한 점수를 구할 수 있다.
  - [x] queen은 9점, rook은 5점, bishop은 3점, knight는 2.5점이다.
  - [x] pawn의 기본 점수는 1점이지만, 같은 세로줄에 같은 색의 폰이 있는 경우 1점이 아닌 0.5점을 준다.
  - [x] king은 잡히는 경우 경기가 끝나기 때문에 점수가 없다.

### piece
- [x] 체스말을 생성할 수 있다.
  - [x] 폰을 생성할 수 있다.
  - [x] 룩을 생성할 수 있다.
  - [x] 비숍을 생성할 수 있다.
  - [x] 나이트 생성할 수 있다.
  - [x] 퀸 생성할 수 있다.
  - [x] 킹 생성할 수 있다.
- [x] 체스말은 색깔에 따라 다른 이름을 가진다.
- [x] 비숍의 이동 규칙
  - [x] 대각선에 위치한 모든 칸으로 이동할 수 있다.
  - [x] 상하좌우에 위치한 모든 칸으로 이동할 수 없다.
- [x] 킹의 이동 규칙
  - [x] 모든 방향으로 1칸 이동할 수 있다.
  - [x] 2칸 이상 이동할 수 없다.
- [x] 나이트의 이동 규칙
  - [x] 상하 중 한 방향으로 2칸 이동 후 좌우로 1칸 이동할 수 있다.
  - [x] 좌우 중 한 방향으로 2칸 이동 후 상하로 1칸 이동할 수 있다.
  - [x] 상하 중 한 방향으로 2칸 이동 후 좌우로 1칸 또는 좌우 중 한 방향으로 2칸 이동 후 상하로 1칸이 아닌 좌표로는 이동할 수 없다.
- [x] 폰의 이동 규칙
  - [x] 검은색일 때 초기 위치일 경우 아래, 오른쪽 아래 대각선, 왼쪽 아래 대각선으로 한 칸, 아래로 두 칸 이동 할 수 있다.
  - [x] 흰색일 때 초기 위치일 경우 위, 오른쪽 위 대각선, 왼쪽 위 대각선으로 한 칸, 위로 두 칸 이동 할 수 있다.
  - [x] 검은색일 때 초기 위치가 아닐 경우 아래, 오른쪽 아래 대각선, 왼쪽 아래 대각선으로 한 칸만 이동할 수 있다.
  - [x] 흰색일 때 초기 위치가 아닐 경우 위, 오른쪽 위 대각선, 왼쪽 위 대각선으로 한 칸만 이동할 수 있다.
- [x] 퀸의 이동 규칙
  - [x] 상하좌우에 위치한 모든 칸으로 이동할 수 있다.
  - [x] 대각선에 위치한 모든 칸으로 이동할 수 있다.
- [x] 룩의 이동 규칙
  - [x] 상하좌우에 위치한 모든 칸으로 이동할 수 있다.
  - [x] 대각선에 위치한 모든 칸으로 이동할 수 없다.

### position
- [x] 말의 기본적인 이동은 8방향으로 이루어지고, 이동한 후의 위치를 반환할 수 있다.
- [x] 출발 좌표부터 목표 좌표까지의 이동 경로를 반환할 수 있다.
  - [x] 상하좌우 경로 (출발 좌표 기준으로 상하좌우 직선 상에 도착 좌표가 존재하면 경로를 계산한다.)
  - [x] 대각선 경로 (출발 좌표 기준으로 대각선 직선 상에 도착 좌표가 존재하면 경로를 계산한다.)
  - [x] 상하좌우, 대각선 경로 밖에 목표 좌표가 위치하면 목표 좌표만을 경로로 반환한다.
- [x] 검은색 폰의 초기 위치를 판단할 수 있다.
- [x] 흰색 폰의 초기 위치를 판단할 수 있다.
- [x] 다른 position 간의 행 좌표값 차이를 구할 수 있다.
- [x] 다른 positino 간의 열 좌표값 차이를 구할 수 있다.

## view

---

### 입력
- [x] 게임 시작 명령어를 입력 받는다.
- [x] 게임 종료 명령어를 입력 받는다.
- [x] 말 이동 명령어를 입력 받는다.

### 출력
- [x] 게임 시작 문구를 출력한다.
- [x] 명령어 안내 문구를 출력한다.
- [x] 체스판 현황을 출력한다.
  - [x] 상대 말을 대문자로 출력한다.
  - [x] 자신의 말은 소문자로 출력한다.
  - [x] 말이 존재하는 위치는 이니셜로 출력한다.
  - [x] 말이 없는 위치는 `.`으로 출력한다.

## DB

---

- [x] 저장
  - [x] 체스판 상태를 문자열로 변환해 저장
- [x] 불러오기
  - [x] db에 저장된 문자열을 각 기물로 매핑

```sql
USE chess;

CREATE TABLE chess_game (
    board_row8 VARCHAR(255) NOT NULL,
    board_row7 VARCHAR(255) NOT NULL,
    board_row6 VARCHAR(255) NOT NULL,
    board_row5 VARCHAR(255) NOT NULL,
    board_row4 VARCHAR(255) NOT NULL,
    board_row3 VARCHAR(255) NOT NULL,
    board_row2 VARCHAR(255) NOT NULL,
    board_row1 VARCHAR(255) NOT NULL
);
```